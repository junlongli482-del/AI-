import{r as t}from"./request-49VFfJMC.js";const e=e=>t({url:`/v2/interaction/documents/${e}/like`,method:"post"}),o=e=>t({url:`/v2/interaction/documents/${e}/like-status`,method:"get"}),a=e=>t({url:`/v2/interaction/documents/${e}/favorite`,method:"post"}),s=e=>t({url:`/v2/interaction/documents/${e}/favorite-status`,method:"get"}),i=(e={})=>t({url:"/v2/interaction/my-favorites",method:"get",params:{page:1,size:20,...e}}),n=(e,o)=>t({url:`/v2/interaction/documents/${e}/comments`,method:"post",data:o}),r=(e,o={})=>t({url:`/v2/interaction/documents/${e}/comments`,method:"get",params:{page:1,size:20,...o}}),d=e=>t({url:`/v2/interaction/comments/${e}`,method:"delete"}),m=()=>t({url:"/v2/interaction/my-stats",method:"get"}),c=t=>t&&0!==t.length?Promise.all(t.map(async t=>{try{const[e,a]=await Promise.all([o(t),s(t)]);return{documentId:t,is_liked:e.is_liked,is_favorited:a.is_favorited,like_count:e.like_count,favorite_count:a.favorite_count}}catch(e){return console.warn(`获取文档${t}状态失败:`,e),{documentId:t,is_liked:!1,is_favorited:!1,like_count:0,favorite_count:0}}})).then(t=>{const e={};return t.forEach(t=>{e[t.documentId]=t}),e}):Promise.resolve({}),u=new Map,l=(t,e)=>{const o={...u.get(t)||{},...e};u.set(t,o),window.dispatchEvent(new CustomEvent("documentInteractionUpdate",{detail:{documentId:t,data:o}}))},v=t=>u.get(t)||null,g=t=>t&&0!==t?t<1e3?t.toString():t<1e4?(t/1e3).toFixed(1)+"k":t<1e8?(t/1e4).toFixed(1)+"w":"99w+":"0",h=(t,e,o)=>{if(!e||!t)return!1;const a=t.user.id===e.id,s=o&&o.author_id===e.id;return a||s},f=t=>t&&t.trim()?t.trim().length<2?{valid:!1,message:"评论内容至少需要2个字符"}:t.length>1e3?{valid:!1,message:"评论内容不能超过1000个字符"}:{valid:!0,message:""}:{valid:!1,message:"评论内容不能为空"};export{i as a,c as b,v as c,e as d,h as e,g as f,m as g,r as h,n as i,d as j,o as k,s as l,a as t,l as u,f as v};
