import{_ as a,r as e,k as s,E as l,c as t,b as c,f as n,w as i,g as r,t as u,d as o,l as d,i as v,u as f,o as p,h as m,j as h,m as y}from"./index-mLi0s7WA.js";import{r as k}from"./request-49VFfJMC.js";import{g as b}from"./index-CtoQaP6o.js";import{u as w}from"./user-DXv7J6WQ.js";const g={class:"user-center-container"},_={class:"header"},C={class:"header-content"},x={class:"user-menu"},$={class:"user-info"},j={class:"username"},z={class:"main-content"},A={class:"content-wrapper"},D={class:"profile-main-card"},M={class:"profile-header"},q={class:"avatar-section"},U={class:"avatar-circle"},V={class:"avatar-text"},B={class:"profile-info"},I={class:"display-name"},T={class:"username-text"},Z={class:"user-badges"},E={class:"badge member-since"},K={class:"profile-stats"},L={class:"stat-item"},N={class:"stat-number"},S={class:"stat-item"},F={class:"stat-number"},G={class:"stat-item"},H={class:"stat-number"},J={class:"features-grid"},O={class:"details-card"},P={class:"info-grid"},Q={class:"info-item"},R={class:"info-value"},W={class:"info-item"},X={class:"info-value"},Y={class:"info-item"},aa={class:"nickname-section"},ea={key:0,class:"info-value"},sa={key:0,class:"checking-icon"},la={key:1,class:"success-icon"},ta={key:2,class:"error-icon"},ca={key:3,class:"edit-buttons"},na={class:"info-item"},ia={class:"info-value"},ra={class:"actions-card"},ua={class:"actions-grid"},oa=a({__name:"UserCenter",setup(a){const oa=f(),da=w(),va=e(null),fa=e({}),pa=e(!1),ma=e(""),ha=e(!1),ya=e(!1),ka=e(null);s(async()=>{await ba(),await wa()});const ba=async()=>{try{va.value=await k({url:"v1/user_profile/me",method:"get"})}catch(a){l.error("è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥")}},wa=async()=>{try{const a=await b();fa.value={documentsCount:a.total_documents||0,favoritesCount:a.total_favorites||0,likesCount:a.total_likes_received||0}}catch(a){console.warn("è·å–ç”¨æˆ·ç»Ÿè®¡å¤±è´¥:",a)}},ga=()=>{if(!va.value?.created_at)return"æ–°æˆå‘˜";const a=new Date(va.value.created_at),e=new Date,s=Math.abs(e-a),l=Math.ceil(s/864e5);if(l<30)return"æ–°æˆå‘˜";if(l<365){return`${Math.floor(l/30)}ä¸ªæœˆ`}return`${Math.floor(l/365)}å¹´`},_a=()=>{pa.value=!0,ma.value=va.value?.nickname||""},Ca=()=>{pa.value=!1,ma.value="",ka.value=null},xa=async()=>{if(ma.value&&ma.value!==va.value?.nickname)if(/^[\u4e00-\u9fa5a-zA-Z0-9]{2,20}$/.test(ma.value)){ya.value=!0;try{const e=await(a=ma.value,k({url:`v1/user_profile/check-nickname/${a}`,method:"get"}));ka.value=e.available}catch(e){ka.value=null}finally{ya.value=!1}var a}else ka.value=null;else ka.value=null},$a=async()=>{if(ma.value)if(/^[ä¸€-é¾¥a-zA-Z0-9]{2,20}$/.test(ma.value))if(ma.value!==va.value?.nickname)if(await xa(),!1!==ka.value){ha.value=!0;try{await(a=ma.value,k({url:"v1/user_profile/nickname",method:"put",data:{nickname:a}})),l.success("æ˜µç§°ä¿®æ”¹æˆåŠŸ"),await ba(),pa.value=!1,ka.value=null}catch(e){}finally{ha.value=!1}var a}else l.error("è¯¥æ˜µç§°å·²è¢«ä½¿ç”¨");else Ca();else l.warning("æ˜µç§°å¿…é¡»æ˜¯2-20ä¸ªå­—ç¬¦ï¼Œæ”¯æŒä¸­è‹±æ–‡å’Œæ•°å­—");else l.warning("è¯·è¾“å…¥æ˜µç§°")},ja=async a=>{"home"===a?oa.push("/home"):"logout"===a&&await za()},za=async()=>{try{await y.confirm("ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ","æç¤º",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}),da.logout(),l.success("å·²é€€å‡ºç™»å½•"),oa.push("/login")}catch{}},Aa=a=>{if(!a)return"æœªçŸ¥";return new Date(a).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit"})};return(a,e)=>{const s=r("el-dropdown-item"),l=r("el-dropdown-menu"),f=r("el-dropdown"),y=r("el-input"),k=r("el-button");return p(),t("div",g,[c("header",_,[c("div",C,[c("h1",{class:"logo",onClick:e[0]||(e[0]=e=>a.$router.push("/home"))},"ç”¨æˆ·ç³»ç»Ÿ"),c("div",x,[n(f,{onCommand:ja},{dropdown:i(()=>[n(l,null,{default:i(()=>[n(s,{command:"home"},{default:i(()=>[...e[8]||(e[8]=[m("ğŸ  è¿”å›ä¸»é¡µ",-1)])]),_:1}),n(s,{command:"logout",divided:""},{default:i(()=>[...e[9]||(e[9]=[m("ğŸšª é€€å‡ºç™»å½•",-1)])]),_:1})]),_:1})]),default:i(()=>[c("div",$,[c("span",j,u(va.value?.username||"ç”¨æˆ·"),1),e[7]||(e[7]=c("span",{class:"arrow"},"â–¼",-1))])]),_:1})])])]),c("main",z,[c("div",A,[c("div",D,[c("div",M,[c("div",q,[c("div",U,[c("span",V,u((va.value?.display_name||va.value?.username||"ç”¨æˆ·").charAt(0).toUpperCase()),1)]),c("div",B,[c("h2",I,u(va.value?.display_name||va.value?.username),1),c("p",T,"@"+u(va.value?.username),1),c("div",Z,[e[10]||(e[10]=c("span",{class:"badge verified"},"å·²éªŒè¯",-1)),c("span",E,u(ga()),1)])])]),c("div",K,[c("div",L,[c("span",N,u(fa.value.documentsCount||0),1),e[11]||(e[11]=c("span",{class:"stat-label"},"æ–‡æ¡£",-1))]),c("div",S,[c("span",F,u(fa.value.favoritesCount||0),1),e[12]||(e[12]=c("span",{class:"stat-label"},"æ”¶è—",-1))]),c("div",G,[c("span",H,u(fa.value.likesCount||0),1),e[13]||(e[13]=c("span",{class:"stat-label"},"ç‚¹èµ",-1))])])])]),c("div",J,[c("div",{class:"feature-card primary",onClick:e[1]||(e[1]=e=>a.$router.push("/my-favorites"))},[...e[14]||(e[14]=[o('<div class="feature-icon" data-v-636afe7c>ğŸ“š</div><div class="feature-content" data-v-636afe7c><h3 class="feature-title" data-v-636afe7c>æˆ‘çš„æ”¶è—</h3><p class="feature-desc" data-v-636afe7c>æŸ¥çœ‹æ”¶è—çš„æ–‡æ¡£</p></div><div class="feature-arrow" data-v-636afe7c>â†’</div>',3)])]),c("div",{class:"feature-card secondary",onClick:e[2]||(e[2]=e=>a.$router.push("/document-manager"))},[...e[15]||(e[15]=[o('<div class="feature-icon" data-v-636afe7c>ğŸ“</div><div class="feature-content" data-v-636afe7c><h3 class="feature-title" data-v-636afe7c>æ–‡æ¡£ç®¡ç†</h3><p class="feature-desc" data-v-636afe7c>ç®¡ç†æˆ‘çš„æ–‡æ¡£</p></div><div class="feature-arrow" data-v-636afe7c>â†’</div>',3)])]),c("div",{class:"feature-card tertiary",onClick:e[3]||(e[3]=e=>a.$router.push("/tech-square"))},[...e[16]||(e[16]=[o('<div class="feature-icon" data-v-636afe7c>ğŸŒŸ</div><div class="feature-content" data-v-636afe7c><h3 class="feature-title" data-v-636afe7c>æŠ€æœ¯å¹¿åœº</h3><p class="feature-desc" data-v-636afe7c>å‘ç°ä¼˜è´¨å†…å®¹</p></div><div class="feature-arrow" data-v-636afe7c>â†’</div>',3)])]),c("div",{class:"feature-card quaternary",onClick:e[4]||(e[4]=e=>a.$router.push("/ai-platform"))},[...e[17]||(e[17]=[o('<div class="feature-icon" data-v-636afe7c>ğŸ¤–</div><div class="feature-content" data-v-636afe7c><h3 class="feature-title" data-v-636afe7c>AIå¹³å°</h3><p class="feature-desc" data-v-636afe7c>æ™ºèƒ½åŠ©æ‰‹å·¥å…·</p></div><div class="feature-arrow" data-v-636afe7c>â†’</div>',3)])])]),c("div",O,[e[25]||(e[25]=c("h3",{class:"card-title"},"è´¦æˆ·ä¿¡æ¯",-1)),c("div",P,[c("div",Q,[e[18]||(e[18]=c("div",{class:"info-label"},[c("span",{class:"label-icon"},"ğŸ‘¤"),c("span",{class:"label-text"},"ç”¨æˆ·å")],-1)),c("span",R,u(va.value?.username),1)]),c("div",W,[e[19]||(e[19]=c("div",{class:"info-label"},[c("span",{class:"label-icon"},"ğŸ“§"),c("span",{class:"label-text"},"é‚®ç®±")],-1)),c("span",X,u(va.value?.email),1)]),c("div",Y,[e[23]||(e[23]=c("div",{class:"info-label"},[c("span",{class:"label-icon"},"âœ¨"),c("span",{class:"label-text"},"æ˜µç§°")],-1)),c("div",aa,[pa.value?(p(),d(y,{key:1,modelValue:ma.value,"onUpdate:modelValue":e[5]||(e[5]=a=>ma.value=a),placeholder:"è¯·è¾“å…¥æ˜µç§°ï¼ˆ2-20ä¸ªå­—ç¬¦ï¼‰",class:"nickname-input",onKeyup:v($a,["enter"])},{suffix:i(()=>[ya.value?(p(),t("span",sa,"â³")):!0===ka.value?(p(),t("span",la,"âœ“")):!1===ka.value?(p(),t("span",ta,"âœ—")):h("",!0)]),_:1},8,["modelValue"])):(p(),t("span",ea,u(va.value?.nickname||"æœªè®¾ç½®"),1)),pa.value?(p(),t("div",ca,[n(k,{type:"primary",size:"small",onClick:$a,loading:ha.value},{default:i(()=>[...e[21]||(e[21]=[m(" ä¿å­˜ ",-1)])]),_:1},8,["loading"]),n(k,{size:"small",onClick:Ca},{default:i(()=>[...e[22]||(e[22]=[m(" å–æ¶ˆ ",-1)])]),_:1})])):(p(),d(k,{key:2,type:"primary",text:"",onClick:_a,class:"edit-btn"},{default:i(()=>[...e[20]||(e[20]=[m(" ç¼–è¾‘ ",-1)])]),_:1}))])]),c("div",na,[e[24]||(e[24]=c("div",{class:"info-label"},[c("span",{class:"label-icon"},"ğŸ“…"),c("span",{class:"label-text"},"æ³¨å†Œæ—¶é—´")],-1)),c("span",ia,u(Aa(va.value?.created_at)),1)])])]),c("div",ra,[c("div",ua,[n(k,{type:"primary",onClick:e[6]||(e[6]=e=>a.$router.push("/change-password")),class:"action-button primary-action"},{default:i(()=>[...e[26]||(e[26]=[c("span",{class:"action-icon"},"ğŸ”’",-1),c("span",{class:"action-text"},"ä¿®æ”¹å¯†ç ",-1)])]),_:1}),n(k,{onClick:za,class:"action-button secondary-action"},{default:i(()=>[...e[27]||(e[27]=[c("span",{class:"action-icon"},"ğŸšª",-1),c("span",{class:"action-text"},"é€€å‡ºç™»å½•",-1)])]),_:1})])])])])])}}},[["__scopeId","data-v-636afe7c"]]);export{oa as default};
