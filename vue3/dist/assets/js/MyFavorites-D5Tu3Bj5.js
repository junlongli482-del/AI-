import{_ as e,r as a,p as t,k as s,E as n,c as l,b as i,f as o,w as c,g as r,t as u,j as d,F as m,e as p,u as v,o as f,s as h,h as y,q as g,m as _}from"./index-mLi0s7WA.js";import{u as k}from"./user-DXv7J6WQ.js";import{a as w,t as C}from"./index-CtoQaP6o.js";import"./request-49VFfJMC.js";const x={class:"favorites-container"},b={class:"header"},$={class:"header-content"},j={class:"user-menu"},M={class:"user-info"},q={class:"username"},z={class:"main-content"},B={class:"favorites-card"},T={class:"page-header"},D={class:"header-left"},F={class:"header-stats"},I={class:"stats-text"},U={class:"favorites-content"},E={key:0,class:"loading-state"},L={key:1,class:"empty-state"},N={key:2,class:"favorites-list"},P=["onClick"],S={class:"item-header"},A={class:"item-title"},G={class:"item-type"},H={class:"item-summary"},J={class:"item-footer"},K={class:"favorite-time"},O={class:"item-actions"},Q={key:3,class:"pagination-wrapper"},R=e({__name:"MyFavorites",setup(e){const R=v(),V=k(),W=a(!1),X=a([]),Y=a(1),Z=a(10),ee=a(0),ae=a([]),te=t(()=>Math.ceil(ee.value/Z.value));s(()=>{se()});const se=async()=>{W.value=!0;try{const e=await w({page:Y.value,size:Z.value});X.value=e.items,ee.value=e.total}catch(e){n.error("èŽ·å–æ”¶è—åˆ—è¡¨å¤±è´¥")}finally{W.value=!1}},ne=e=>{R.push(`/tech-square/document/${e}`)},le=e=>{Y.value=e,se()},ie=async e=>{"user-center"===e?R.push("/user-center"):"home"===e?R.push("/home"):"logout"===e&&await oe()},oe=async()=>{try{await _.confirm("ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ","æç¤º",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}),V.logout(),n.success("å·²é€€å‡ºç™»å½•"),R.push("/login")}catch{}},ce=e=>{if(!e)return"æœªçŸ¥";const a=new Date(e),t=new Date-a;if(t<36e5){const e=Math.floor(t/6e4);return e<1?"åˆšåˆš":`${e}åˆ†é’Ÿå‰`}if(t<864e5){return`${Math.floor(t/36e5)}å°æ—¶å‰`}if(t<6048e5){return`${Math.floor(t/864e5)}å¤©å‰`}return a.toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit"})};return(e,a)=>{const t=r("el-dropdown-item"),s=r("el-dropdown-menu"),v=r("el-dropdown"),k=r("el-button"),w=r("el-skeleton"),R=r("el-pagination");return f(),l("div",x,[i("header",b,[i("div",$,[i("h1",{class:"logo",onClick:a[0]||(a[0]=a=>e.$router.push("/home"))},"ç”¨æˆ·ç³»ç»Ÿ"),i("div",j,[o(v,{onCommand:ie},{dropdown:c(()=>[o(s,null,{default:c(()=>[o(t,{command:"user-center"},{default:c(()=>[...a[5]||(a[5]=[y("ðŸ‘¤ ä¸ªäººä¸­å¿ƒ",-1)])]),_:1}),o(t,{command:"home"},{default:c(()=>[...a[6]||(a[6]=[y("ðŸ  è¿”å›žä¸»é¡µ",-1)])]),_:1}),o(t,{command:"logout",divided:""},{default:c(()=>[...a[7]||(a[7]=[y("ðŸšª é€€å‡ºç™»å½•",-1)])]),_:1})]),_:1})]),default:c(()=>[i("div",M,[i("span",q,u(h(V).userInfo?.username||"ç”¨æˆ·"),1),a[4]||(a[4]=i("span",{class:"arrow"},"â–¼",-1))])]),_:1})])])]),i("main",z,[i("div",B,[i("div",T,[i("div",D,[o(k,{text:"",onClick:a[1]||(a[1]=a=>e.$router.push("/user-center")),class:"back-button"},{default:c(()=>[...a[8]||(a[8]=[y(" â† è¿”å›žä¸ªäººä¸­å¿ƒ ",-1)])]),_:1}),a[9]||(a[9]=i("h2",{class:"page-title"},"æˆ‘çš„æ”¶è—",-1))]),i("div",F,[i("span",I,"å…± "+u(ee.value)+" ä¸ªæ”¶è—",1)])]),i("div",U,[W.value?(f(),l("div",E,[o(w,{rows:3,animated:""})])):0===X.value.length?(f(),l("div",L,[a[11]||(a[11]=i("div",{class:"empty-icon"},"ðŸ“š",-1)),a[12]||(a[12]=i("h3",{class:"empty-title"},"æš‚æ— æ”¶è—",-1)),a[13]||(a[13]=i("p",{class:"empty-description"},"åŽ»æŠ€æœ¯å¹¿åœºå‘çŽ°ä¼˜è´¨å†…å®¹å§ï¼",-1)),o(k,{type:"primary",onClick:a[2]||(a[2]=a=>e.$router.push("/tech-square")),class:"empty-action"},{default:c(()=>[...a[10]||(a[10]=[y(" åŽ»æŠ€æœ¯å¹¿åœº ",-1)])]),_:1})])):(f(),l("div",N,[(f(!0),l(m,null,p(X.value,e=>(f(),l("div",{key:e.id,class:"favorite-item"},[i("div",{class:"item-content",onClick:a=>ne(e.document_id)},[i("div",S,[i("h3",A,u(e.document_title),1),i("div",G,[i("span",{class:g(["type-badge",e.file_type])},u(e.file_type.toUpperCase()),3)])]),i("p",H,u(e.document_summary||"æš‚æ— æ‘˜è¦"),1),i("div",J,[i("span",K," æ”¶è—äºŽ "+u(ce(e.created_at)),1)])],8,P),i("div",O,[o(k,{text:"",type:"primary",onClick:a=>ne(e.document_id),class:"action-btn"},{default:c(()=>[...a[14]||(a[14]=[y(" æŸ¥çœ‹ ",-1)])]),_:1},8,["onClick"]),o(k,{text:"",type:"danger",onClick:a=>(async e=>{try{await _.confirm(`ç¡®å®šè¦å–æ¶ˆæ”¶è—ã€Š${e.document_title}ã€‹å—ï¼Ÿ`,"å–æ¶ˆæ”¶è—",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}),ae.value.push(e.document_id);try{await C(e.document_id),n.success("å–æ¶ˆæ”¶è—æˆåŠŸ"),X.value=X.value.filter(a=>a.document_id!==e.document_id),ee.value--,0===X.value.length&&Y.value>1&&(Y.value--,se())}catch(a){n.error("å–æ¶ˆæ”¶è—å¤±è´¥")}finally{ae.value=ae.value.filter(a=>a!==e.document_id)}}catch{}})(e),loading:ae.value.includes(e.document_id),class:"action-btn"},{default:c(()=>[...a[15]||(a[15]=[y(" å–æ¶ˆæ”¶è— ",-1)])]),_:1},8,["onClick","loading"])])]))),128))])),te.value>1?(f(),l("div",Q,[o(R,{"current-page":Y.value,"onUpdate:currentPage":a[3]||(a[3]=e=>Y.value=e),"page-size":Z.value,total:ee.value,layout:"prev, pager, next",onCurrentChange:le,class:"favorites-pagination"},null,8,["current-page","page-size","total"])])):d("",!0)])])])])}}},[["__scopeId","data-v-decbb1b0"]]);export{R as default};
