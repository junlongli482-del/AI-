# ğŸ“˜ 12-åˆ†äº«ç³»ç»Ÿæ¨¡å— - å‰ç«¯æ¥å£æ–‡æ¡£

> **æ¨¡å—è·¯å¾„**ï¼š`/api/v2/share_system`  
> **æ¥å£æ•°é‡**ï¼š11ä¸ª  
> **è®¤è¯è¦æ±‚**ï¼šâœ… å¤§éƒ¨åˆ†éœ€è¦ç™»å½•

---

## ğŸ”— æ¥å£åˆ—è¡¨

### åˆ†äº«ç®¡ç† (6ä¸ª)
1. **åˆ›å»ºåˆ†äº«é“¾æ¥** - `POST /create`
2. **æˆ‘çš„åˆ†äº«åˆ—è¡¨** - `GET /my-shares`
3. **è·å–åˆ†äº«è¯¦æƒ…** - `GET /detail/{share_id}`
4. **æ›´æ–°åˆ†äº«é…ç½®** - `PUT /update/{share_id}`
5. **åˆ é™¤åˆ†äº«** - `DELETE /delete/{share_id}`
6. **åˆ‡æ¢åˆ†äº«çŠ¶æ€** - `POST /toggle-status/{share_id}`

### å…¬å¼€è®¿é—® (3ä¸ª)
7. **è®¿é—®åˆ†äº«æ–‡æ¡£** - `POST /public/{share_code}` âŒ æ— éœ€è®¤è¯
8. **è·å–åˆ†äº«æ–‡æ¡£** - `GET /public/{share_code}` âŒ æ— éœ€è®¤è¯
9. **ä¸‹è½½åˆ†äº«æ–‡æ¡£** - `GET /download/{share_code}` âŒ æ— éœ€è®¤è¯

### ç»Ÿè®¡é…ç½® (2ä¸ª)
10. **åˆ†äº«ç»Ÿè®¡ä¿¡æ¯** - `GET /stats`
11. **åˆ†äº«é…ç½®ä¿¡æ¯** - `GET /config`

---

## ğŸ“‹ æ¥å£è¯¦æƒ…

### 1. åˆ›å»ºåˆ†äº«é“¾æ¥

**è¯·æ±‚å‚æ•°**
```json
{
  "document_id": 123,
  "share_type": "public",           // public | private | password
  "share_password": null,           // å¯†ç ä¿æŠ¤æ—¶å¿…å¡«
  "allow_download": true,
  "allow_comment": true,
  "expire_hours": 168               // è¿‡æœŸæ—¶é—´(å°æ—¶)ï¼Œnullä¸ºæ°¸ä¸è¿‡æœŸ
}
```

**æˆåŠŸå“åº” (200)**
```json
{
  "id": 1,
  "document_id": 123,
  "share_code": "abc12345",
  "share_type": "public",
  "share_url": "http://localhost:8100/api/v2/share_system/public/abc12345",
  "allow_download": true,
  "allow_comment": true,
  "status": "active",
  "expire_time": "2025-02-03T10:30:45.123456",
  "view_count": 0,
  "download_count": 0,
  "created_at": "2025-01-27T10:30:45.123456",
  "updated_at": "2025-01-27T10:30:45.123456",
  "document_title": "Vue3å¼€å‘æŒ‡å—",
  "document_summary": "è¯¦ç»†ä»‹ç»Vue3çš„æ–°ç‰¹æ€§"
}
```

**é”™è¯¯å“åº”**
- `400` - `{"detail": "è¯¥æ–‡æ¡£å·²å­˜åœ¨æ´»è·ƒçš„åˆ†äº«é“¾æ¥"}`
- `404` - `{"detail": "æ–‡æ¡£ä¸å­˜åœ¨æˆ–æ— æƒé™è®¿é—®"}`

### 2. æˆ‘çš„åˆ†äº«åˆ—è¡¨

**æŸ¥è¯¢å‚æ•°**
- `page=1` - é¡µç  (â‰¥1)
- `size=20` - æ¯é¡µæ•°é‡ (1-100)

**æˆåŠŸå“åº” (200)**
```json
{
  "items": [
    {
      "id": 1,
      "document_id": 123,
      "share_code": "abc12345",
      "share_type": "public",
      "share_url": "http://localhost:8100/api/v2/share_system/public/abc12345",
      "status": "active",
      "view_count": 25,
      "download_count": 5,
      "document_title": "Vue3å¼€å‘æŒ‡å—"
    }
  ],
  "total": 10,
  "page": 1,
  "size": 20,
  "pages": 1
}
```

### 3. è·å–åˆ†äº«è¯¦æƒ…

**æˆåŠŸå“åº” (200)**
```json
{
  "id": 1,
  "document_id": 123,
  "share_code": "abc12345",
  "share_type": "public",
  "share_url": "http://localhost:8100/api/v2/share_system/public/abc12345",
  "allow_download": true,
  "allow_comment": true,
  "status": "active",
  "view_count": 25,
  "download_count": 5,
  "today_views": 3,
  "week_views": 15,
  "month_views": 25,
  "recent_access_logs": [
    {
      "id": 1,
      "access_type": "VIEW",
      "access_result": "success",
      "visitor_ip": "192.168.1.100",
      "visitor_user_id": 456,
      "visitor_username": "alice",
      "accessed_at": "2025-01-27T10:30:45.123456"
    }
  ]
}
```

### 4. æ›´æ–°åˆ†äº«é…ç½®

**è¯·æ±‚å‚æ•°**
```json
{
  "share_type": "password",         // å¯é€‰
  "share_password": "123456",       // å¯é€‰
  "allow_download": false,          // å¯é€‰
  "allow_comment": true,            // å¯é€‰
  "expire_hours": 72,               // å¯é€‰
  "status": "active"                // å¯é€‰
}
```

**æˆåŠŸå“åº” (200)** - åŒåˆ›å»ºåˆ†äº«å“åº”æ ¼å¼

### 5. åˆ é™¤åˆ†äº«

**æˆåŠŸå“åº” (200)**
```json
{
  "message": "åˆ†äº«åˆ é™¤æˆåŠŸ"
}
```

### 6. è®¿é—®åˆ†äº«æ–‡æ¡£ï¼ˆå…¬å¼€æ¥å£ï¼‰

**è¯·æ±‚å‚æ•°**
```json
{
  "password": "123456"              // å¯†ç ä¿æŠ¤æ—¶å¿…å¡«
}
```

**æˆåŠŸå“åº” (200)**
```json
{
  "id": 123,
  "title": "Vue3å¼€å‘æŒ‡å—",
  "content": "# Vue3å¼€å‘æŒ‡å—\n\nè¯¦ç»†å†…å®¹...",
  "summary": "è¯¦ç»†ä»‹ç»Vue3çš„æ–°ç‰¹æ€§",
  "file_type": "md",
  "file_size": 15360,
  "author_username": "alice",
  "publish_time": "2025-01-27T10:30:45.123456",
  "view_count": 26,
  "allow_download": true,
  "allow_comment": true
}
```

**é”™è¯¯å“åº”**
- `400` - `{"detail": "åˆ†äº«å¯†ç é”™è¯¯"}`
- `401` - `{"detail": "éœ€è¦ç™»å½•æ‰èƒ½è®¿é—®æ­¤åˆ†äº«"}`
- `404` - `{"detail": "åˆ†äº«é“¾æ¥ä¸å­˜åœ¨"}`

### 7. è·å–åˆ†äº«æ–‡æ¡£ï¼ˆGETæ–¹å¼ï¼‰

**æŸ¥è¯¢å‚æ•°**
- `password` - å¯†ç ä¿æŠ¤æ—¶ä¼ å…¥

**æˆåŠŸå“åº” (200)** - åŒè®¿é—®åˆ†äº«æ–‡æ¡£å“åº”æ ¼å¼

### 8. ä¸‹è½½åˆ†äº«æ–‡æ¡£ï¼ˆå…¬å¼€æ¥å£ï¼‰

**æˆåŠŸå“åº” (200)**
- è¿”å›æ–‡ä»¶ä¸‹è½½æµ
- æ–‡ä»¶åæ ¼å¼ï¼š`{document_title}.md`

**é”™è¯¯å“åº”**
- `403` - `{"detail": "è¯¥åˆ†äº«ä¸å…è®¸ä¸‹è½½"}`
- `404` - `{"detail": "æ–‡ä»¶ä¸å­˜åœ¨"}`

### 9. åˆ†äº«ç»Ÿè®¡ä¿¡æ¯

**æˆåŠŸå“åº” (200)**
```json
{
  "total_shares": 10,
  "active_shares": 8,
  "expired_shares": 1,
  "disabled_shares": 1,
  "total_views": 150,
  "total_downloads": 30,
  "today_views": 5,
  "week_views": 25,
  "month_views": 100,
  "popular_shares": [
    {
      "id": 1,
      "document_title": "Vue3å¼€å‘æŒ‡å—",
      "view_count": 50,
      "share_url": "http://localhost:8100/api/v2/share_system/public/abc12345"
    }
  ]
}
```

### 10. åˆ‡æ¢åˆ†äº«çŠ¶æ€

**æˆåŠŸå“åº” (200)**
```json
{
  "message": "åˆ†äº«çŠ¶æ€å·²åˆ‡æ¢ä¸ºdisabled",
  "share": {
    "id": 1,
    "status": "disabled",
    "document_title": "Vue3å¼€å‘æŒ‡å—"
  }
}
```

### 11. åˆ†äº«é…ç½®ä¿¡æ¯

**æˆåŠŸå“åº” (200)**
```json
{
  "share_types": [
    {
      "value": "public",
      "label": "å…¬å¼€åˆ†äº«",
      "description": "ä»»ä½•äººéƒ½å¯ä»¥è®¿é—®"
    },
    {
      "value": "private",
      "label": "ç§æœ‰åˆ†äº«",
      "description": "éœ€è¦ç™»å½•æ‰èƒ½è®¿é—®"
    },
    {
      "value": "password",
      "label": "å¯†ç ä¿æŠ¤",
      "description": "éœ€è¦å¯†ç æ‰èƒ½è®¿é—®"
    }
  ],
  "max_expire_hours": 8760,
  "default_expire_hours": 168,
  "max_shares_per_document": 1,
  "supported_download_types": ["md", "pdf"],
  "base_share_url": "http://localhost:8100/api/v2/share_system/public/"
}
```

---

## ğŸ” åˆ†äº«ç±»å‹è¯´æ˜

| ç±»å‹ | è¯´æ˜ | è®¿é—®è¦æ±‚ |
|------|------|----------|
| `public` | å…¬å¼€åˆ†äº« | æ— éœ€è®¤è¯ |
| `private` | ç§æœ‰åˆ†äº« | éœ€è¦ç™»å½• |
| `password` | å¯†ç ä¿æŠ¤ | éœ€è¦å¯†ç  |

---

## ğŸ“Š åˆ†äº«çŠ¶æ€è¯´æ˜

| çŠ¶æ€ | è¯´æ˜ | å¯è®¿é—®æ€§ |
|------|------|----------|
| `active` | æ´»è·ƒ | å¯æ­£å¸¸è®¿é—® |
| `expired` | å·²è¿‡æœŸ | æ— æ³•è®¿é—® |
| `disabled` | å·²ç¦ç”¨ | æ— æ³•è®¿é—® |

---

## âŒ é”™è¯¯å“åº”

- `400` - `{"detail": "åˆ†äº«é“¾æ¥å·²å¤±æ•ˆ"}`
- `401` - `{"detail": "éœ€è¦ç™»å½•æ‰èƒ½è®¿é—®æ­¤åˆ†äº«"}`
- `403` - `{"detail": "è¯¥åˆ†äº«ä¸å…è®¸ä¸‹è½½"}`
- `404` - `{"detail": "åˆ†äº«é“¾æ¥ä¸å­˜åœ¨"}`
