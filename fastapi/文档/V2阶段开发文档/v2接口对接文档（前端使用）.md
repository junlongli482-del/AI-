# 📘 FastAPI 文档管理系统 - 前端开发接口文档

> **项目状态**：✅ **后端开发完成，可开始前端开发**  
> **最后更新**：2025年10月16日  
> **接口版本**：v6.0

---

## 📋 目录

- [1. 项目概述](#1-项目概述)
- [2. 环境配置](#2-环境配置)
- [3. 接口文档](#3-接口文档)
- [4. 错误处理](#4-错误处理)
- [5. 开发指南](#5-开发指南)

---

## 1. 项目概述

### 1.1 项目简介

FastAPI文档管理系统是一个企业级文档管理平台，支持用户注册登录、文档管理、AI集成、分享系统等功能。

### 1.2 技术架构

- **后端框架**：FastAPI
- **数据库**：MySQL
- **认证方式**：JWT Token
- **文件支持**：Markdown、PDF

### 1.3 功能模块

```
✅ v1 用户系统 (4个模块)：
├── user_register      ✅ 用户注册
├── user_auth          ✅ 用户认证  
├── user_profile       ✅ 用户中心
└── password_manager   ✅ 密码管理

✅ v2 文档系统 (7个模块)：
├── document_manager   ✅ 文档管理
├── file_upload        ✅ 文件上传
├── md_editor          ✅ MD编辑器
├── ai_review          ✅ AI审核
├── document_publish   ✅ 文档发布
├── tech_square        ✅ 技术广场
├── interaction        ✅ 互动功能
└── share_system       ✅ 分享系统
```

---

## 2. 环境配置

### 2.1 基础信息

- **API基础地址**：`http://localhost:8100`
- **认证方式**：`Authorization: Bearer <access_token>`
- **Content-Type**：`application/json`

### 2.2 测试账号

- **用户名**：`abc`
- **密码**：`ljl18420`
- **邮箱**：`ljlaa@qq.com`

### 2.3 登录示例

```javascript
// 登录接口调用示例
const loginResponse = await fetch('http://localhost:8100/api/v1/user_auth/login', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    username_or_email: 'abc',
    password: 'ljl18420'
  })
});

const loginData = await loginResponse.json();
// 返回格式：
// {
//   "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...",
//   "refresh_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...",
//   "token_type": "bearer",
//   "expires_in": 1800
// }
```

---

## 3. 接口文档

### 3.1 v1 用户系统接口

#### 3.1.1 用户注册模块 (`/api/v1/user_register`)

| 接口路径 | 方法 | 功能 | 认证 | 说明 |
|----------|------|------|------|------|
| `/register` | POST | 用户注册 | ❌ | 注册新用户账号 |
| `/check-username/{username}` | GET | 检查用户名可用性 | ❌ | 实时验证用户名 |
| `/check-email/{email}` | GET | 检查邮箱可用性 | ❌ | 实时验证邮箱 |



#### 3.1.2 用户认证模块 (`/api/v1/user_auth`)

| 接口路径 | 方法 | 功能 | 认证 | 说明 |
|----------|------|------|------|------|
| `/login` | POST | 用户登录 | ❌ | 获取访问令牌 |
| `/refresh` | POST | 刷新token | ✅ | 刷新访问令牌 |
| `/logout` | POST | 退出登录 | ✅ | 注销当前会话 |

#### 3.1.3 用户中心模块 (`/api/v1/user_profile`)

| 接口路径 | 方法 | 功能 | 认证 | 说明 |
|----------|------|------|------|------|
| `/me` | GET | 获取当前用户信息 | ✅ | 用户个人信息 |
| `/nickname` | PUT | 更新昵称 | ✅ | 修改用户昵称 |
| `/check-nickname/{nickname}` | GET | 检查昵称可用性 | ✅ | 实时验证昵称 |
| `/user-info` | GET | 获取用户信息 | ✅ | 详细用户信息 |

#### 3.1.4 密码管理模块 (`/api/v1/password_manager`)

| 接口路径 | 方法 | 功能 | 认证 | 说明 |
|----------|------|------|------|------|
| `/change-password` | POST | 修改密码 | ✅ | 更改用户密码 |
| `/check-strength` | POST | 检查密码强度 | ❌ | 密码强度验证 |

---

### 3.2 v2 文档系统接口

#### 3.2.1 文档管理模块 (`/api/v2/document_manager`)

**文件夹管理**：
| 接口路径 | 方法 | 功能 | 认证 | 说明 |
|----------|------|------|------|------|
| `/folders` | POST | 创建文件夹 | ✅ | 最多3层嵌套 |
| `/folders/tree` | GET | 获取文件夹树 | ✅ | 树形结构展示 |
| `/folders/{folder_id}` | DELETE | 删除文件夹 | ✅ | 级联删除 |

**文档管理**：
| 接口路径 | 方法 | 功能 | 认证 | 说明 |
|----------|------|------|------|------|
| `/documents` | POST | 创建文档 | ✅ | 新建文档 |
| `/documents` | GET | 获取文档列表 | ✅ | 支持分页筛选 |
| `/documents/{doc_id}` | GET | 获取文档详情 | ✅ | 文档完整信息 |
| `/documents/{doc_id}` | PUT | 更新文档 | ✅ | 修改文档内容 |
| `/documents/{doc_id}` | DELETE | 删除文档 | ✅ | 删除文档 |
| `/stats` | GET | 获取统计信息 | ✅ | 文档统计数据 |

**下载pdf文件**：
| **下载文档文件** | **GET** | **`/documents/{doc_id}/download`** | **下载文档文件** | **✅** |
| **流式传输文档** | **GET** | **`/documents/{doc_id}/stream`** | **流式传输文档（PDF预览）** | **✅** |
| **获取文件信息** | **GET** | **`/documents/{doc_id}/info`** | **获取文档文件信息** | **✅** |



#### 3.2.2 文件上传模块 (`/api/v2/file_upload`)

| 接口路径 | 方法 | 功能 | 认证 | 说明 |
|----------|------|------|------|------|
| `/config` | GET | 获取上传配置 | ✅ | 文件大小限制等 |
| `/validate` | POST | 验证文件 | ✅ | 上传前验证 |
| `/upload` | POST | 上传文件 | ✅ | 支持MD/PDF |
| `/uploads` | GET | 获取上传历史 | ✅ | 分页查询 |
| `/uploads/{upload_id}` | GET | 获取上传详情 | ✅ | 单个文件信息 |
| `/create-document` | POST | 创建文档 | ✅ | 从上传文件创建 |
| `/uploads/{upload_id}` | DELETE | 删除上传记录 | ✅ | 删除文件 |
| `/stats` | GET | 获取上传统计 | ✅ | 上传统计数据 |



#### 3.2.3 MD编辑器模块 (`/api/v2/md_editor`)

**会话管理**：
| 接口路径 | 方法 | 功能 | 认证 | 说明 |
|----------|------|------|------|------|
| `/config` | GET | 获取编辑器配置 | ✅ | 编辑器设置 |
| `/sessions` | POST | 创建编辑器会话 | ✅ | 新建/编辑会话 |
| `/sessions` | GET | 获取会话列表 | ✅ | 分页查询 |
| `/sessions/{session_id}` | GET | 获取会话详情 | ✅ | 会话内容 |
| `/sessions/{session_id}` | PUT | 更新会话内容 | ✅ | 保存草稿 |
| `/sessions/{session_id}` | DELETE | 删除会话 | ✅ | 删除会话 |

**AI优化功能**：
| 接口路径 | 方法 | 功能 | 认证 | 说明 |
|----------|------|------|------|------|
| `/sessions/{session_id}/optimize` | POST | AI优化内容 | ✅ | 内容优化 |
| `/sessions/{session_id}/apply-optimization/{optimization_id}` | POST | 应用优化结果 | ✅ | 应用AI建议 |
| `/sessions/{session_id}/optimizations` | GET | 获取优化历史 | ✅ | 优化记录 |

**文档保存**：
| 接口路径 | 方法 | 功能 | 认证 | 说明 |
|----------|------|------|------|------|
| `/sessions/{session_id}/save-document` | POST | 保存为正式文档 | ✅ | 发布文档 |
| `/stats` | GET | 获取编辑器统计 | ✅ | 使用统计 |

#### 3.2.4 AI审核模块 (`/api/v2/ai_review`)

| 接口路径 | 方法 | 功能 | 认证 | 说明 |
|----------|------|------|------|------|
| `/submit-review` | POST | 提交文档审核 | ✅ | 手动提交审核 |
| `/review-status/{document_id}` | GET | 查询审核状态 | ✅ | 审核进度查询 |
| `/review-history` | GET | 获取审核历史 | ✅ | 历史记录 |
| `/review-detail/{review_id}` | GET | 获取审核详情 | ✅ | 详细审核结果 |
| `/retry-review/{document_id}` | POST | 重新审核文档 | ✅ | 重新提交审核 |
| `/stats` | GET | 获取审核统计 | ✅ | 审核统计数据 |
| `/config` | GET | 获取审核配置 | ✅ | 审核规则配置 |
| `/recent-reviews` | GET | 获取最近审核 | ✅ | 最近审核记录 |

#### 3.2.5 文档发布模块 (`/api/v2/document_publish`)

| 接口路径 | 方法 | 功能 | 认证 | 说明 |
|----------|------|------|------|------|
| `/submit` | POST | 提交文档发布 | ✅ | 发布文档到广场 |
| `/published` | GET | 获取已发布文档 | ❌ | 公开文档列表 |
| `/document/{doc_id}` | GET | 获取文档发布详情 | ✅ | 发布状态信息 |
| `/unpublish/{doc_id}` | POST | 撤回已发布文档 | ✅ | 取消发布 |
| `/my-records` | GET | 获取我的发布记录 | ✅ | 个人发布历史 |
| `/stats` | GET | 获取发布统计 | ✅ | 发布统计数据 |
| `/view/{doc_id}` | POST | 增加文档浏览量 | ❌ | 浏览量统计 |
| `/status/{doc_id}` | GET | 获取文档发布状态 | ✅ | 发布状态查询 |
| `/config` | GET | 获取发布配置 | ❌ | 发布规则配置 |

#### 3.2.6 技术广场模块 (`/api/v2/tech_square`)

| 接口路径 | 方法 | 功能 | 认证 | 说明 |
|----------|------|------|------|------|
| `/documents` | GET | 获取文档列表 | ❌ | 支持筛选排序 |
| `/documents/{document_id}` | GET | 获取文档详情 | ❌ | 文档完整内容 |
| `/search` | GET | 搜索文档 | ❌ | 关键词搜索 |
| `/category-stats` | GET | 获取分类统计 | ❌ | 分类数量统计 |
| `/hot-documents` | GET | 获取热门文档 | ❌ | 热门推荐 |
| `/latest-documents` | GET | 获取最新文档 | ❌ | 最新发布 |
| `/stats` | GET | 获取技术广场统计 | ❌ | 整体统计 |
| `/view/{document_id}` | POST | 增加文档浏览量 | ❌ | 浏览量+1 |



#### 3.2.7 互动功能模块 (`/api/v2/interaction`)

| 接口路径 | 方法 | 功能 | 认证 | 说明 |
|----------|------|------|------|------|
| `/documents/{document_id}/like` | POST | 切换点赞状态 | ✅ | 点赞/取消点赞 |
| `/documents/{document_id}/like-status` | GET | 获取点赞状态 | ❌ | 查询是否已点赞 |
| `/documents/{document_id}/favorite` | POST | 切换收藏状态 | ✅ | 收藏/取消收藏 |
| `/documents/{document_id}/favorite-status` | GET | 获取收藏状态 | ❌ | 查询是否已收藏 |
| `/my-favorites` | GET | 获取我的收藏列表 | ✅ | 个人收藏夹 |
| `/documents/{document_id}/comments` | POST | 创建评论或回复 | ✅ | 发表评论 |
| `/documents/{document_id}/comments` | GET | 获取评论列表 | ❌ | 文档评论 |
| `/comments/{comment_id}` | PUT | 更新评论 | ✅ | 修改评论 |
| `/comments/{comment_id}` | DELETE | 删除评论 | ✅ | 删除评论 |
| `/documents/{document_id}/stats` | GET | 获取文档互动统计 | ❌ | 点赞收藏数 |
| `/my-stats` | GET | 获取我的互动统计 | ✅ | 个人互动数据 |



#### 3.2.8 分享系统模块 (`/api/v2/share_system`)

| 接口路径 | 方法 | 功能 | 认证 | 说明 |
|----------|------|------|------|------|
| `/create` | POST | 创建文档分享 | ✅ | 生成分享链接 |
| `/my-shares` | GET | 获取我的分享列表 | ✅ | 个人分享管理 |
| `/detail/{share_id}` | GET | 获取分享详情 | ✅ | 分享配置信息 |
| `/update/{share_id}` | PUT | 更新分享配置 | ✅ | 修改分享设置 |
| `/delete/{share_id}` | DELETE | 删除分享 | ✅ | 删除分享链接 |
| `/public/{share_code}` | POST | 访问分享文档 | 🔓 | 访问分享内容 |
| `/public/{share_code}` | GET | 访问分享文档 | 🔓 | 获取分享内容 |
| `/download/{share_code}` | GET | 下载分享文档 | 🔓 | 下载文档文件 |
| `/stats` | GET | 获取分享统计 | ✅ | 分享数据统计 |
| `/toggle-status/{share_id}` | POST | 切换分享状态 | ✅ | 启用/禁用分享 |
| `/config` | GET | 获取分享配置 | ❌ | 分享规则配置 |

**分享类型说明**：
- **🌐 公开分享**：任何人都可以访问，无需登录
- **🔒 私有分享**：需要登录才能访问
- **🔑 密码分享**：需要输入密码才能访问

## 4. 错误处理

### 4.1 HTTP状态码

| 状态码 | 说明 | 常见场景 |
|--------|------|----------|
| 200 | 成功 | 操作成功完成 |
| 400 | 请求错误 | 参数验证失败、业务逻辑错误 |
| 401 | 认证失败 | Token无效或过期 |
| 404 | 资源不存在 | 文档、用户不存在 |
| 422 | 数据格式错误 | JSON格式错误 |
| 500 | 服务器错误 | 内部服务器错误 |


### 5.5 开发建议

1. **统一API调用**：封装统一的API请求函数
2. **错误处理**：建立完善的错误处理机制
3. **Token管理**：实现自动Token刷新
4. **分页组件**：封装可复用的分页组件
5. **文件上传**：支持拖拽上传和进度显示
6. **实时更新**：对于审核状态等使用轮询或WebSocket
7. **缓存策略**：合理使用本地缓存减少API调用
8. **用户体验**：添加加载状态和友好的错误提示

---

## 📊 接口总览

```
接口统计：
├── v1 用户系统: 12个接口
├── v2 文档管理: 8个接口
├── v2 文件上传: 8个接口
├── v2 MD编辑器: 11个接口
├── v2 AI审核: 9个接口
├── v2 文档发布: 10个接口
├── v2 技术广场: 8个接口
├── v2 互动功能: 11个接口
└── v2 分享系统: 12个接口

总计: 89个接口
认证接口: 67个
公开接口: 22个
```

**🎯 开发优先级建议**：
1. **用户系统** → 登录注册功能(已经完成)
2. **文档管理** → 基础文档CRUD
3. **文件上传** → 文件上传功能
4. **技术广场** → 文档展示页面
5. **互动功能** → 点赞评论功能
6. **分享系统** → 文档分享功能
7. **MD编辑器** → 在线编辑器
8. **AI功能** → AI审核和优化

# 最高优先级指令1：详细的接口文档列表如下，需要哪个要跟用户索要。不可自己猜测数据长什么样，一切基于现实内容。

    接口文档（超详细版本）
        00-API总览.md
        01-用户注册模块.md
        02-用户认证模块.md
        03-用户中心模块.md
        04-密码管理模块.md
        05-文档管理模块.md
        06-文件上传模块.md
        07-MD编辑器模块.md
        08-AI审核模块.md
        09-文档发布模块.md
        10-技术广场模块.md
        11-互动功能模块.md
        12-分享系统模块.md
