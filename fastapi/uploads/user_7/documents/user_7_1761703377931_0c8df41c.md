# ğŸ“˜ 07-MDç¼–è¾‘å™¨æ¨¡å— - å‰ç«¯æ¥å£æ–‡æ¡£

> **æ¨¡å—è·¯å¾„**ï¼š`/api/v2/md_editor`  
> **æ¥å£æ•°é‡**ï¼š11ä¸ª  
> **è®¤è¯è¦æ±‚**ï¼šâœ… éœ€è¦ç™»å½•

---

## ğŸ”— æ¥å£åˆ—è¡¨

### ä¼šè¯ç®¡ç† (6ä¸ª)
1. **åˆ›å»ºç¼–è¾‘ä¼šè¯** - `POST /sessions`
2. **è·å–ä¼šè¯åˆ—è¡¨** - `GET /sessions`
3. **è·å–ä¼šè¯è¯¦æƒ…** - `GET /sessions/{session_id}`
4. **æ›´æ–°ä¼šè¯å†…å®¹** - `PUT /sessions/{session_id}`
5. **åˆ é™¤ç¼–è¾‘ä¼šè¯** - `DELETE /sessions/{session_id}`
6. **ä¿å­˜ä¸ºæ–‡æ¡£** - `POST /sessions/{session_id}/save-document`

### AIä¼˜åŒ–åŠŸèƒ½ (3ä¸ª)
7. **AIå†…å®¹ä¼˜åŒ–** - `POST /sessions/{session_id}/optimize`
8. **åº”ç”¨ä¼˜åŒ–ç»“æœ** - `POST /sessions/{session_id}/apply-optimization/{optimization_id}`
9. **ä¼˜åŒ–å†å²è®°å½•** - `GET /sessions/{session_id}/optimizations`

### é…ç½®ç»Ÿè®¡ (2ä¸ª)
10. **ç¼–è¾‘å™¨ç»Ÿè®¡** - `GET /stats`
11. **ç¼–è¾‘å™¨é…ç½®** - `GET /config`

---

## ğŸ“‹ æ¥å£è¯¦æƒ…

### 1. åˆ›å»ºç¼–è¾‘ä¼šè¯

**è¯·æ±‚å‚æ•°**
```json
{
  "document_id": 123,                    // å¯é€‰ï¼Œç¼–è¾‘ç°æœ‰æ–‡æ¡£æ—¶ä¼ å…¥
  "title": "æˆ‘çš„æ–°æ–‡æ¡£",                  // å¯é€‰ï¼Œæ–‡æ¡£æ ‡é¢˜
  "content": "# æ ‡é¢˜\nå†…å®¹...",          // å¯é€‰ï¼Œåˆå§‹å†…å®¹
  "session_type": "new_document"         // new_document | edit_document
}
```

**æˆåŠŸå“åº” (200)**
```json
{
  "id": 1,
  "document_id": 123,
  "title": "æˆ‘çš„æ–°æ–‡æ¡£",
  "content": "# æ ‡é¢˜\nå†…å®¹...",
  "is_draft": true,
  "session_type": "new_document",
  "created_at": "2025-01-27T10:30:45.123456",
  "updated_at": "2025-01-27T10:30:45.123456"
}
```

### 2. è·å–ä¼šè¯åˆ—è¡¨

**æŸ¥è¯¢å‚æ•°**
- `skip=0` - è·³è¿‡è®°å½•æ•°
- `limit=20` - è¿”å›è®°å½•æ•° (1-100)

**æˆåŠŸå“åº” (200)**
```json
[
  {
    "id": 1,
    "document_id": 123,
    "title": "æˆ‘çš„æ–‡æ¡£",
    "content": "å†…å®¹é¢„è§ˆ...",
    "is_draft": true,
    "session_type": "new_document",
    "created_at": "2025-01-27T10:30:45.123456",
    "updated_at": "2025-01-27T10:30:45.123456"
  }
]
```

### 3. è·å–ä¼šè¯è¯¦æƒ…

**æˆåŠŸå“åº” (200)**
```json
{
  "id": 1,
  "document_id": 123,
  "title": "æˆ‘çš„æ–‡æ¡£",
  "content": "å®Œæ•´å†…å®¹...",
  "is_draft": true,
  "session_type": "new_document",
  "created_at": "2025-01-27T10:30:45.123456",
  "updated_at": "2025-01-27T10:30:45.123456",
  "ai_optimizations": [
    {
      "id": 1,
      "original_content": "åŸå§‹å†…å®¹",
      "optimized_content": "ä¼˜åŒ–åå†…å®¹",
      "optimization_prompt": "ä¼˜åŒ–ç±»å‹: general",
      "ai_provider": "default",
      "status": "completed",
      "created_at": "2025-01-27T10:30:45.123456"
    }
  ]
}
```

### 4. æ›´æ–°ä¼šè¯å†…å®¹

**è¯·æ±‚å‚æ•°**
```json
{
  "title": "æ›´æ–°çš„æ ‡é¢˜",        // å¯é€‰
  "content": "æ›´æ–°çš„å†…å®¹",     // å¯é€‰
  "is_draft": false          // å¯é€‰ï¼Œæ˜¯å¦ä¸ºè‰ç¨¿
}
```

**æˆåŠŸå“åº” (200)** - åŒåˆ›å»ºä¼šè¯å“åº”æ ¼å¼

### 5. åˆ é™¤ç¼–è¾‘ä¼šè¯

**æˆåŠŸå“åº” (200)**
```json
{
  "success": true,
  "message": "ä¼šè¯åˆ é™¤æˆåŠŸ"
}
```

### 6. AIå†…å®¹ä¼˜åŒ–

**è¯·æ±‚å‚æ•°**
```json
{
  "content": "è¦ä¼˜åŒ–çš„MDå†…å®¹",
  "optimization_type": "general"    // general | grammar | structure | expand
}
```

**æˆåŠŸå“åº” (200)**
```json
{
  "success": true,
  "message": "å†…å®¹ä¼˜åŒ–æˆåŠŸ",
  "optimization_id": 1,
  "original_content": "åŸå§‹å†…å®¹",
  "optimized_content": "ä¼˜åŒ–åçš„å†…å®¹",
  "can_apply": true
}
```

### 7. åº”ç”¨ä¼˜åŒ–ç»“æœ

**æˆåŠŸå“åº” (200)**
```json
{
  "success": true,
  "message": "ä¼˜åŒ–ç»“æœå·²åº”ç”¨"
}
```

### 8. ä¿å­˜ä¸ºæ–‡æ¡£

**è¯·æ±‚å‚æ•°**
```json
{
  "title": "æ–‡æ¡£æ ‡é¢˜",
  "folder_id": 123,           // å¯é€‰ï¼Œæ–‡ä»¶å¤¹ID
  "summary": "æ–‡æ¡£æ‘˜è¦"       // å¯é€‰ï¼Œæ–‡æ¡£æ‘˜è¦
}
```

**æˆåŠŸå“åº” (200)**
```json
{
  "success": true,
  "message": "æ–‡æ¡£ä¿å­˜æˆåŠŸ",
  "document_id": 456,
  "document_title": "æ–‡æ¡£æ ‡é¢˜"
}
```

### 9. ç¼–è¾‘å™¨ç»Ÿè®¡

**æˆåŠŸå“åº” (200)**
```json
{
  "total_sessions": 15,
  "draft_sessions": 8,
  "total_optimizations": 25,
  "recent_sessions": [
    {
      "id": 1,
      "title": "æœ€è¿‘çš„æ–‡æ¡£",
      "is_draft": true,
      "created_at": "2025-01-27T10:30:45.123456"
    }
  ]
}
```

### 10. ç¼–è¾‘å™¨é…ç½®

**æˆåŠŸå“åº” (200)**
```json
{
  "optimization_types": [
    {
      "value": "general",
      "label": "é€šç”¨ä¼˜åŒ–",
      "description": "æå‡è¡¨è¾¾è´¨é‡å’Œå¯è¯»æ€§"
    },
    {
      "value": "grammar",
      "label": "è¯­æ³•æ£€æŸ¥", 
      "description": "ä¿®æ­£è¯­æ³•å’Œæ‹¼å†™é”™è¯¯"
    }
  ],
  "editor_features": {
    "auto_save": true,
    "syntax_highlight": true,
    "live_preview": true,
    "ai_optimization": true
  },
  "limits": {
    "max_content_length": 50000,
    "max_title_length": 200,
    "max_sessions_per_user": 100
  }
}
```

---

## âŒ é”™è¯¯å“åº”

- `400` - `{"detail": "ä¼šè¯ä¸å­˜åœ¨æˆ–æ— æƒé™è®¿é—®"}`
- `404` - `{"detail": "ä¼šè¯ä¸å­˜åœ¨"}`
- `500` - `{"detail": "åˆ›å»ºä¼šè¯å¤±è´¥: é”™è¯¯ä¿¡æ¯"}`
- `422` - å‚æ•°æ ¼å¼é”™è¯¯ 
