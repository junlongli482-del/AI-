# ğŸ“š FastAPIæ¨¡å—åŒ–ç”¨æˆ·ç³»ç»Ÿ - å®Œæ•´æŠ€æœ¯æ–‡æ¡£

## ğŸ“‹ é¡¹ç›®æ¦‚è§ˆ

è¿™æ˜¯ä¸€ä¸ªåŸºäºFastAPIçš„æ¨¡å—åŒ–ç”¨æˆ·è®¤è¯ç³»ç»Ÿï¼Œé‡‡ç”¨ç‰ˆæœ¬åŒ–æ¶æ„è®¾è®¡ï¼Œæ”¯æŒç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€ç”¨æˆ·ä¸­å¿ƒç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚

**é¡¹ç›®ä¿¡æ¯ï¼š**
- ğŸ  é¡¹ç›®è·¯å¾„ï¼š`C:\A_XM\xm_3\vue3-fastapi-mysql_v1.0\fastapi`
- ğŸŒ æœåŠ¡ç«¯å£ï¼š8100
- ğŸ—„ï¸ æ•°æ®åº“ï¼šMySQL `user_system`
- ğŸ“Š è¡¨å‰ç¼€ï¼š`us_`
- ğŸ—ï¸ æ¶æ„ï¼šæ¨¡å—åŒ– + ç‰ˆæœ¬åŒ–è®¾è®¡

---

## ğŸ”— æ¥å£æ–‡æ¡£ (API Documentation)

### åŸºç¡€ä¿¡æ¯
- **æœåŠ¡åœ°å€**ï¼šhttp://localhost:8100
- **APIç‰ˆæœ¬**ï¼šv1
- **è®¤è¯æ–¹å¼**ï¼šJWT Bearer Token
- **æ–‡æ¡£åœ°å€**ï¼šhttp://localhost:8100/docs

---

### 1ï¸âƒ£ ç”¨æˆ·æ³¨å†Œæ¨¡å— (user_register)

#### 1.1 ç”¨æˆ·æ³¨å†Œæ¥å£

**æ¥å£åœ°å€ï¼š** `POST /api/v1/user_register/register`

**åŠŸèƒ½æè¿°ï¼š** æ–°ç”¨æˆ·è´¦å·æ³¨å†Œ

**è¯·æ±‚å‚æ•°ï¼š**
```json
{
  "username": "string",     // ç”¨æˆ·åï¼Œ3-20å­—ç¬¦ï¼Œå”¯ä¸€
  "email": "string",        // é‚®ç®±åœ°å€ï¼Œå”¯ä¸€
  "password": "string"      // å¯†ç ï¼Œæœ€å°‘8ä½ï¼ŒåŒ…å«å­—æ¯å’Œæ•°å­—
}
```

**æˆåŠŸå“åº”ï¼ˆ201ï¼‰ï¼š**
```json
{
  "message": "ç”¨æˆ·æ³¨å†ŒæˆåŠŸ",
  "user": {
    "id": 1,
    "username": "testuser",
    "email": "test@example.com",
    "is_active": true,
    "created_at": "2025-01-20T10:30:00"
  }
}
```

**é”™è¯¯å“åº”ï¼š**
- `400` - ç”¨æˆ·åå·²å­˜åœ¨ï¼š`{"detail": "ç”¨æˆ·åå·²è¢«æ³¨å†Œ"}`
- `400` - é‚®ç®±å·²å­˜åœ¨ï¼š`{"detail": "é‚®ç®±å·²è¢«æ³¨å†Œ"}`
- `422` - æ•°æ®éªŒè¯é”™è¯¯

#### 1.2 æ£€æŸ¥ç”¨æˆ·åå¯ç”¨æ€§

**æ¥å£åœ°å€ï¼š** `GET /api/v1/user_register/check-username/{username}`

**æˆåŠŸå“åº”ï¼ˆ200ï¼‰ï¼š**
```json
{
  "available": true,
  "message": "ç”¨æˆ·åå¯ç”¨",
  "username": "testuser"
}
```

#### 1.3 æ£€æŸ¥é‚®ç®±å¯ç”¨æ€§

**æ¥å£åœ°å€ï¼š** `GET /api/v1/user_register/check-email/{email}`

**æˆåŠŸå“åº”ï¼ˆ200ï¼‰ï¼š**
```json
{
  "available": true,
  "message": "é‚®ç®±å¯ç”¨",
  "email": "test@example.com"
}
```

#### 1.4 æ¨¡å—æµ‹è¯•æ¥å£

**æ¥å£åœ°å€ï¼š** `GET /api/v1/user_register/test`

**æˆåŠŸå“åº”ï¼ˆ200ï¼‰ï¼š**
```json
{
  "message": "ç”¨æˆ·æ³¨å†Œæ¨¡å—æ­£å¸¸è¿è¡Œ",
  "module": "user_register",
  "version": "v1",
  "endpoints": [...],
  "database_status": "æ­£å¸¸ (ç”¨æˆ·æ€»æ•°: 5)"
}
```

---

### 2ï¸âƒ£ ç”¨æˆ·è®¤è¯æ¨¡å— (user_auth)

#### 2.1 ç”¨æˆ·ç™»å½•æ¥å£

**æ¥å£åœ°å€ï¼š** `POST /api/v1/user_auth/login`

**åŠŸèƒ½æè¿°ï¼š** æ”¯æŒç”¨æˆ·å/é‚®ç®± + å¯†ç ä¸¤ç§ç™»å½•æ–¹å¼

**è¯·æ±‚å‚æ•°ï¼š**
```json
{
  "username_or_email": "string",  // ç”¨æˆ·åæˆ–é‚®ç®±åœ°å€
  "password": "string",           // ç”¨æˆ·å¯†ç 
  "remember_me": false           // æ˜¯å¦è®°ä½ç™»å½•ï¼ˆå¯é€‰ï¼‰
}
```

**æˆåŠŸå“åº”ï¼ˆ200ï¼‰ï¼š**
```json
{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "refresh_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...", // remember_me=trueæ—¶æ‰æœ‰
  "token_type": "bearer",
  "expires_in": 1800  // 30åˆ†é’Ÿï¼Œå•ä½ï¼šç§’
}
```

**é”™è¯¯å“åº”ï¼š**
- `401` - ç™»å½•å¤±è´¥ï¼š`{"detail": "ç”¨æˆ·å/é‚®ç®±æˆ–å¯†ç é”™è¯¯"}`

#### 2.2 è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯

**æ¥å£åœ°å€ï¼š** `GET /api/v1/user_auth/me`

**è¯·æ±‚å¤´ï¼š**
```
Authorization: Bearer <access_token>
```

**æˆåŠŸå“åº”ï¼ˆ200ï¼‰ï¼š**
```json
{
  "id": 2,
  "username": "testuser",
  "email": "test@example.com",
  "is_active": true,
  "created_at": "2025-01-20T10:30:00"
}
```

#### 2.3 åˆ·æ–°è®¿é—®ä»¤ç‰Œ

**æ¥å£åœ°å€ï¼š** `POST /api/v1/user_auth/refresh`

**è¯·æ±‚å‚æ•°ï¼š**
```json
{
  "refresh_token": "string"  // åˆ·æ–°ä»¤ç‰Œ
}
```

**æˆåŠŸå“åº”ï¼ˆ200ï¼‰ï¼š**
```json
{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "refresh_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "token_type": "bearer",
  "expires_in": 1800
}
```

---

### 3ï¸âƒ£ ç”¨æˆ·ä¸­å¿ƒæ¨¡å— (user_profile)

#### 3.1 è·å–ç”¨æˆ·èµ„æ–™

**æ¥å£åœ°å€ï¼š** `GET /api/v1/user_profile/me`

**è¯·æ±‚å¤´ï¼š**
```
Authorization: Bearer <access_token>
```

**æˆåŠŸå“åº”ï¼ˆ200ï¼‰ï¼š**
```json
{
  "id": 2,
  "username": "testuser",
  "email": "test@example.com",
  "nickname": "æˆ‘çš„æ˜µç§°",
  "display_name": "æˆ‘çš„æ˜µç§°",
  "is_active": true,
  "created_at": "2025-01-20 10:30:00",
  "updated_at": "2025-01-20 11:00:00"
}
```

#### 3.2 æ›´æ–°ç”¨æˆ·æ˜µç§°

**æ¥å£åœ°å€ï¼š** `PUT /api/v1/user_profile/nickname`

**è¯·æ±‚å¤´ï¼š**
```
Authorization: Bearer <access_token>
```

**è¯·æ±‚å‚æ•°ï¼š**
```json
{
  "nickname": "æˆ‘çš„æ–°æ˜µç§°"  // 2-20å­—ç¬¦ï¼Œæ”¯æŒä¸­è‹±æ–‡æ•°å­—ï¼Œå¯ä¸ºnullæ¸…ç©º
}
```

**æˆåŠŸå“åº”ï¼ˆ200ï¼‰ï¼š**
```json
{
  "message": "æ˜µç§°æ›´æ–°æˆåŠŸ",
  "success": true,
  "user": {
    "id": 2,
    "username": "testuser",
    "nickname": "æˆ‘çš„æ–°æ˜µç§°",
    "display_name": "æˆ‘çš„æ–°æ˜µç§°"
  }
}
```

**é”™è¯¯å“åº”ï¼š**
- `400` - æ˜µç§°å·²è¢«ä½¿ç”¨ï¼š`{"detail": "è¯¥æ˜µç§°å·²è¢«å…¶ä»–ç”¨æˆ·ä½¿ç”¨"}`

#### 3.3 æ£€æŸ¥æ˜µç§°å¯ç”¨æ€§

**æ¥å£åœ°å€ï¼š** `GET /api/v1/user_profile/check-nickname/{nickname}`

**æˆåŠŸå“åº”ï¼ˆ200ï¼‰ï¼š**
```json
{
  "available": true,
  "message": "æ˜µç§°å¯ç”¨",
  "nickname": "æµ‹è¯•æ˜µç§°"
}
```

#### 3.4 é€€å‡ºç™»å½•

**æ¥å£åœ°å€ï¼š** `POST /api/v1/user_profile/logout`

**è¯·æ±‚å¤´ï¼š**
```
Authorization: Bearer <access_token>
```

**æˆåŠŸå“åº”ï¼ˆ200ï¼‰ï¼š**
```json
{
  "message": "ç”¨æˆ· æˆ‘çš„æ˜µç§° å·²æˆåŠŸé€€å‡ºç™»å½•",
  "success": true
}
```

---

## ğŸ—ï¸ å¼€å‘æ–‡æ¡£ (Development Documentation)

### é¡¹ç›®ç›®å½•ç»“æ„

```
fastapi/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ core/                          # æ ¸å¿ƒç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ config.py                  # é…ç½®ç®¡ç†ï¼ˆå«JWTé…ç½®ï¼‰
â”‚   â”‚   â””â”€â”€ database.py                # æ•°æ®åº“è¿æ¥
â”‚   â”œâ”€â”€ modules/                       # ä¸šåŠ¡æ¨¡å—ï¼ˆç‰ˆæœ¬åŒ–ï¼‰
â”‚   â”‚   â””â”€â”€ v1/                        # ç‰ˆæœ¬1åŠŸèƒ½
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â”œâ”€â”€ user_register/         # ç”¨æˆ·æ³¨å†Œæ¨¡å— âœ…
â”‚   â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚       â”‚   â”œâ”€â”€ models.py          # ç”¨æˆ·æ•°æ®æ¨¡å‹
â”‚   â”‚       â”‚   â”œâ”€â”€ schemas.py         # APIåºåˆ—åŒ–æ¨¡å‹
â”‚   â”‚       â”‚   â”œâ”€â”€ services.py        # æ³¨å†Œä¸šåŠ¡é€»è¾‘
â”‚   â”‚       â”‚   â”œâ”€â”€ routes.py          # æ³¨å†ŒAPIè·¯ç”±
â”‚   â”‚       â”‚   â””â”€â”€ dependencies.py    # æ¨¡å—ä¾èµ–æ³¨å…¥
â”‚   â”‚       â”œâ”€â”€ user_auth/             # ç”¨æˆ·è®¤è¯æ¨¡å— âœ…
â”‚   â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚       â”‚   â”œâ”€â”€ models.py          # å¤ç”¨Useræ¨¡å‹
â”‚   â”‚       â”‚   â”œâ”€â”€ schemas.py         # ç™»å½•è¯·æ±‚/å“åº”æ¨¡å‹
â”‚   â”‚       â”‚   â”œâ”€â”€ services.py        # JWTè®¤è¯æœåŠ¡
â”‚   â”‚       â”‚   â”œâ”€â”€ routes.py          # ç™»å½•APIè·¯ç”±
â”‚   â”‚       â”‚   â””â”€â”€ dependencies.py    # JWTä¾èµ–æ³¨å…¥
â”‚   â”‚       â””â”€â”€ user_profile/          # ç”¨æˆ·ä¸­å¿ƒæ¨¡å— âœ…
â”‚   â”‚           â”œâ”€â”€ __init__.py
â”‚   â”‚           â”œâ”€â”€ models.py          # æ‰©å±•Useræ¨¡å‹ï¼ˆå«æ˜µç§°ï¼‰
â”‚   â”‚           â”œâ”€â”€ schemas.py         # ç”¨æˆ·èµ„æ–™APIæ¨¡å‹
â”‚   â”‚           â”œâ”€â”€ services.py        # ç”¨æˆ·ä¸­å¿ƒä¸šåŠ¡é€»è¾‘
â”‚   â”‚           â”œâ”€â”€ routes.py          # ç”¨æˆ·ä¸­å¿ƒAPIè·¯ç”±
â”‚   â”‚           â””â”€â”€ dependencies.py    # æ¨¡å—ä¾èµ–æ³¨å…¥
â”‚   â””â”€â”€ main.py                        # åº”ç”¨å…¥å£ï¼ˆè‡ªåŠ¨æ³¨å†Œæ¨¡å—ï¼‰
â”œâ”€â”€ requirements.txt                   # é¡¹ç›®ä¾èµ–
â”œâ”€â”€ .env                              # ç¯å¢ƒé…ç½®
â””â”€â”€ README.md                         # é¡¹ç›®è¯´æ˜
```

### æŠ€æœ¯æ¶æ„

**æ ¸å¿ƒæŠ€æœ¯æ ˆï¼š**
- **æ¡†æ¶**ï¼šFastAPI 0.104.1
- **æ•°æ®åº“**ï¼šMySQL + PyMySQL
- **ORM**ï¼šSQLAlchemy 2.0.23
- **è®¤è¯**ï¼šJWT (python-jose[cryptography] 3.3.0)
- **å¯†ç åŠ å¯†**ï¼šSHA256 + ç›å€¼
- **é…ç½®ç®¡ç†**ï¼špython-decouple 3.8

**æ¶æ„ç‰¹ç‚¹ï¼š**
- âœ… **æ¨¡å—åŒ–è®¾è®¡**ï¼šæ¯ä¸ªåŠŸèƒ½ç‹¬ç«‹æ¨¡å—
- âœ… **ç‰ˆæœ¬åŒ–ç®¡ç†**ï¼šæ”¯æŒå¤šç‰ˆæœ¬å¹¶å­˜
- âœ… **è‡ªåŠ¨æ³¨å†Œ**ï¼šæ–°æ¨¡å—é›¶é…ç½®è‡ªåŠ¨å‘ç°
- âœ… **é›¶ä¿®æ”¹åŸåˆ™**ï¼šæ–°åŠŸèƒ½ä¸ä¿®æ”¹ç°æœ‰ä»£ç 
- âœ… **æ ‡å‡†ç»“æ„**ï¼šæ¯ä¸ªæ¨¡å—5ä¸ªæ ‡å‡†æ–‡ä»¶

**JWTé…ç½®ï¼š**
- è®¿é—®ä»¤ç‰Œæœ‰æ•ˆæœŸï¼š30åˆ†é’Ÿ
- åˆ·æ–°ä»¤ç‰Œæœ‰æ•ˆæœŸï¼š7å¤©
- åŠ å¯†ç®—æ³•ï¼šHS256

### æ•°æ®åº“è®¾è®¡

**è¡¨åï¼š** `us_users`

**è¡¨ç»“æ„ï¼š**
```sql
CREATE TABLE us_users (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50) NOT NULL UNIQUE,
    email VARCHAR(100) NOT NULL UNIQUE,
    password_hash VARCHAR(255) NOT NULL,  -- æ ¼å¼ï¼šç›å€¼:å“ˆå¸Œå€¼
    nickname VARCHAR(50) DEFAULT NULL UNIQUE,  -- ç”¨æˆ·æ˜µç§°ï¼ˆæ–°å¢ï¼‰
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    INDEX idx_username (username),
    INDEX idx_email (email),
    INDEX idx_nickname (nickname)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
```

**å­—æ®µè¯´æ˜ï¼š**
- `id`ï¼šä¸»é”®ï¼Œè‡ªå¢
- `username`ï¼šç”¨æˆ·åï¼Œ3-20å­—ç¬¦ï¼Œå”¯ä¸€
- `email`ï¼šé‚®ç®±åœ°å€ï¼Œå”¯ä¸€
- `password_hash`ï¼šå¯†ç å“ˆå¸Œï¼Œæ ¼å¼ï¼š`ç›å€¼:SHA256å“ˆå¸Œå€¼`
- `nickname`ï¼šç”¨æˆ·æ˜µç§°ï¼Œ2-20å­—ç¬¦ï¼Œå”¯ä¸€ï¼Œå¯ä¸ºNULL
- `is_active`ï¼šè´¦æˆ·çŠ¶æ€ï¼Œé»˜è®¤æ¿€æ´»
- `created_at`ï¼šåˆ›å»ºæ—¶é—´
- `updated_at`ï¼šæ›´æ–°æ—¶é—´

**æ˜¾ç¤ºåç§°é€»è¾‘ï¼š**
- ä¼˜å…ˆæ˜¾ç¤ºæ˜µç§°ï¼ˆå¦‚æœè®¾ç½®äº†ï¼‰
- æ˜µç§°ä¸ºç©ºæ—¶æ˜¾ç¤ºç”¨æˆ·å

### å·²å®ŒæˆåŠŸèƒ½æ¸…å•

#### âœ… ç”¨æˆ·æ³¨å†Œæ¨¡å— (user_register)
- [x] ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½
- [x] ç”¨æˆ·åå”¯ä¸€æ€§éªŒè¯
- [x] é‚®ç®±å”¯ä¸€æ€§éªŒè¯
- [x] å¯†ç å¼ºåº¦éªŒè¯
- [x] å®æ—¶å¯ç”¨æ€§æ£€æŸ¥æ¥å£
- [x] æ¨¡å—æµ‹è¯•æ¥å£

#### âœ… ç”¨æˆ·è®¤è¯æ¨¡å— (user_auth)
- [x] åŒé‡ç™»å½•æ–¹å¼ï¼ˆç”¨æˆ·å/é‚®ç®±+å¯†ç ï¼‰
- [x] JWTä»¤ç‰Œç”Ÿæˆå’ŒéªŒè¯
- [x] è®°ä½ç™»å½•çŠ¶æ€ï¼ˆåˆ·æ–°ä»¤ç‰Œï¼‰
- [x] è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
- [x] ä»¤ç‰Œåˆ·æ–°åŠŸèƒ½
- [x] ç”¨æˆ·èº«ä»½éªŒè¯ä¸­é—´ä»¶

#### âœ… ç”¨æˆ·ä¸­å¿ƒæ¨¡å— (user_profile)
- [x] è·å–ç”¨æˆ·å®Œæ•´èµ„æ–™
- [x] æ›´æ–°ç”¨æˆ·æ˜µç§°
- [x] æ˜µç§°å”¯ä¸€æ€§éªŒè¯
- [x] æ˜µç§°å¯ç”¨æ€§æ£€æŸ¥
- [x] é€€å‡ºç™»å½•åŠŸèƒ½
- [x] æ˜¾ç¤ºåç§°ä¼˜å…ˆçº§é€»è¾‘

### å¾…å¼€å‘åŠŸèƒ½æ¸…å•

#### ğŸ”„ å¯†ç ç®¡ç†æ¨¡å— (password_manager)
- [ ] ä¿®æ”¹å¯†ç åŠŸèƒ½
- [ ] åŸå¯†ç éªŒè¯
- [ ] æ–°å¯†ç å¼ºåº¦éªŒè¯
- [ ] å¯†ç ä¿®æ”¹å†å²è®°å½•
- [ ] å¿˜è®°å¯†ç åŠŸèƒ½ï¼ˆå¯é€‰ï¼‰

#### ğŸ”„ ç³»ç»Ÿæ‰©å±•åŠŸèƒ½
- [ ] ç”¨æˆ·å¤´åƒä¸Šä¼ 
- [ ] ä¸ªäººèµ„æ–™æ‰©å±•å­—æ®µ
- [ ] ç”¨æˆ·æƒé™ç®¡ç†
- [ ] æ“ä½œæ—¥å¿—è®°å½•
- [ ] é‚®ç®±éªŒè¯åŠŸèƒ½

---

## ğŸ“‹ ç»§ç»­å¼€å‘æŒ‡å— (Development Continuation Guide)

### ğŸ¯ é¡¹ç›®èƒŒæ™¯ä¿¡æ¯

æˆ‘æ­£åœ¨å¼€å‘ä¸€ä¸ª**æ¨¡å—åŒ–çš„FastAPIç”¨æˆ·ç³»ç»Ÿ**ï¼Œé‡‡ç”¨ç‰ˆæœ¬åŒ–çš„æ¨¡å—æ¶æ„ã€‚ç›®å‰å·²ç»å®Œæˆäº†ç”¨æˆ·æ³¨å†Œã€ç”¨æˆ·è®¤è¯å’Œç”¨æˆ·ä¸­å¿ƒä¸‰ä¸ªæ ¸å¿ƒæ¨¡å—ï¼Œç°åœ¨è¦ç»§ç»­å¼€å‘å¯†ç ç®¡ç†æ¨¡å—ã€‚

### ğŸ“Š å½“å‰é¡¹ç›®çŠ¶æ€

**é¡¹ç›®ä¿¡æ¯ï¼š**
- é¡¹ç›®è·¯å¾„ï¼š`C:\A_XM\xm_3\vue3-fastapi-mysql_v1.0\fastapi`
- æœåŠ¡ç«¯å£ï¼š8100
- æ•°æ®åº“ï¼šMySQLï¼Œæ•°æ®åº“å `user_system`
- è¡¨å‰ç¼€ï¼š`us_`

**æŠ€æœ¯æ ˆï¼š**
- FastAPI + SQLAlchemy + MySQL
- JWTè®¤è¯ï¼ˆpython-joseï¼‰
- å¯†ç åŠ å¯†ï¼ˆSHA256+ç›å€¼ï¼‰
- è‡ªåŠ¨æ¨¡å—æ³¨å†Œæœºåˆ¶

**å·²å®Œæˆæ¨¡å—ï¼š**
1. **ç”¨æˆ·æ³¨å†Œæ¨¡å—**ï¼ˆ`app/modules/v1/user_register/`ï¼‰
2. **ç”¨æˆ·è®¤è¯æ¨¡å—**ï¼ˆ`app/modules/v1/user_auth/`ï¼‰
3. **ç”¨æˆ·ä¸­å¿ƒæ¨¡å—**ï¼ˆ`app/modules/v1/user_profile/`ï¼‰

### ğŸ—„ï¸ æ•°æ®åº“ç»“æ„

**å½“å‰è¡¨ç»“æ„ï¼š**
```sql
-- us_users è¡¨ï¼ˆå·²åŒ…å«nicknameå­—æ®µï¼‰
id, username, email, password_hash, nickname, is_active, created_at, updated_at
-- å¯†ç æ ¼å¼ï¼šç›å€¼:å“ˆå¸Œå€¼
-- æ˜µç§°æ”¯æŒï¼š2-20å­—ç¬¦ï¼Œä¸­è‹±æ–‡æ•°å­—ï¼Œå”¯ä¸€æ€§çº¦æŸ
```

### ğŸ¯ ä¸‹ä¸€æ­¥å¼€å‘éœ€æ±‚

éœ€è¦å¼€å‘**å¯†ç ç®¡ç†æ¨¡å—**ï¼ˆpassword_managerï¼‰ï¼ŒåŠŸèƒ½åŒ…æ‹¬ï¼š
- ä¿®æ”¹å¯†ç åŠŸèƒ½ï¼ˆéªŒè¯åŸå¯†ç ï¼‰
- å¯†ç å¼ºåº¦éªŒè¯
- å¯†ç ä¿®æ”¹æˆåŠŸæç¤º
- å¯é€‰ï¼šå¯†ç ä¿®æ”¹å†å²è®°å½•

### ğŸ—ï¸ æ¨¡å—æ¶æ„è§„èŒƒ

**æ ‡å‡†æ¨¡å—ç»“æ„ï¼š**
```
app/modules/v1/{æ¨¡å—å}/
â”œâ”€â”€ models.py          # æ•°æ®æ¨¡å‹
â”œâ”€â”€ schemas.py         # APIåºåˆ—åŒ–æ¨¡å‹
â”œâ”€â”€ services.py        # ä¸šåŠ¡é€»è¾‘
â”œâ”€â”€ routes.py          # APIè·¯ç”±
â””â”€â”€ dependencies.py    # æ¨¡å—ä¾èµ–
```

**å¼€å‘åŸåˆ™ï¼š**
- âœ… æ–°æ¨¡å—åœ¨ `app/modules/v1/` ä¸‹åˆ›å»ºç›®å½•
- âœ… éµå¾ª5ä¸ªæ ‡å‡†æ–‡ä»¶ç»“æ„
- âœ… main.py è‡ªåŠ¨æ³¨å†Œï¼Œæ— éœ€ä¿®æ”¹
- âœ… æ¨¡å—é—´é€šè¿‡APIé€šä¿¡ï¼Œé¿å…ç›´æ¥ä¾èµ–

### ğŸ”§ é…ç½®æ–‡ä»¶çŠ¶æ€

**app/core/config.pyï¼š**
```python
from decouple import config

class Settings:
    DATABASE_URL: str = config("DATABASE_URL")
    SECRET_KEY: str = config("SECRET_KEY")
    ALGORITHM: str = config("ALGORITHM", default="HS256")
    ACCESS_TOKEN_EXPIRE_MINUTES: int = config("ACCESS_TOKEN_EXPIRE_MINUTES", default=30, cast=int)
    REFRESH_TOKEN_EXPIRE_DAYS: int = config("REFRESH_TOKEN_EXPIRE_DAYS", default=7, cast=int)

settings = Settings()
```

**.env é…ç½®ï¼š**
```env
DATABASE_URL=mysql+pymysql://root:ljl18420@localhost:3306/user_system
SECRET_KEY=your-secret-key-here-change-in-production
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7
```

### ğŸ§ª æµ‹è¯•æ•°æ®

**æµ‹è¯•ç”¨æˆ·ï¼š**
- ç”¨æˆ·åï¼štestuser
- é‚®ç®±ï¼štest@example.com
- å¯†ç ï¼špassword123
- æ˜µç§°ï¼šæˆ‘çš„æ˜µç§°ï¼ˆå¦‚æœå·²è®¾ç½®ï¼‰

**JWTä»¤ç‰Œè·å–ï¼š**
```bash
POST /api/v1/user_auth/login
{
  "username_or_email": "testuser",
  "password": "password123",
  "remember_me": true
}
```

### ğŸ“‹ å¼€å‘æŒ‡å¯¼åŸåˆ™

**å¯¹äºæ–°å¯¹è¯çš„å¼€å‘è€…ï¼š**
1. æˆ‘æ˜¯æœ‰ä¸€å®šåŸºç¡€çš„å°ç™½ï¼Œä½¿ç”¨**æ…¢é€Ÿæ¨¡å¼**æ•™å­¦
2. ä¸€æ¬¡åªå¼€å‘ä¸€ä¸ªæ¨¡å—ï¼Œç¡®ä¿æˆ‘èƒ½è·Ÿä¸Šè¿›åº¦
3. å…ˆæä¾›å®Œæ•´çš„éœ€æ±‚åˆ†æå’Œæ¶æ„è®¾è®¡
4. é€æ­¥ç¼–å†™ä»£ç æ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶éƒ½è¦è¯¦ç»†è§£é‡Š
5. æä¾›å®Œæ•´çš„æµ‹è¯•æŒ‡å¯¼

**é‡è¦æé†’ï¼š**
- main.py æ— éœ€ä¿®æ”¹ï¼Œè‡ªåŠ¨æ³¨å†Œæ–°æ¨¡å—
- å¦‚éœ€æ›´æ–°ç°æœ‰æ–‡ä»¶ï¼Œå…ˆè¦æ±‚æŸ¥çœ‹å½“å‰å†…å®¹
- éµå¾ªæ¨¡å—åŒ–åŸåˆ™ï¼Œé¿å…è·¨æ¨¡å—ç›´æ¥ä¾èµ–

---

## ğŸš€ å¿«é€Ÿå¯åŠ¨å‘½ä»¤ (Quick Start Commands)

### æœåŠ¡å™¨å¯åŠ¨

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd C:\A_XM\xm_3\vue3-fastapi-mysql_v1.0\fastapi

# å¯åŠ¨æœåŠ¡å™¨
python -m app.main

# æœåŠ¡å™¨å°†åœ¨ä»¥ä¸‹åœ°å€å¯åŠ¨ï¼š
# http://localhost:8100
```

### APIæ–‡æ¡£è®¿é—®

```bash
# Swagger UI æ–‡æ¡£
http://localhost:8100/docs

# ReDoc æ–‡æ¡£
http://localhost:8100/redoc
```

### æ¨¡å—æµ‹è¯•å‘½ä»¤

```bash
# æµ‹è¯•ç”¨æˆ·æ³¨å†Œæ¨¡å—
curl http://localhost:8100/api/v1/user_register/test

# æµ‹è¯•ç”¨æˆ·è®¤è¯æ¨¡å—
curl http://localhost:8100/api/v1/user_auth/test

# æµ‹è¯•ç”¨æˆ·ä¸­å¿ƒæ¨¡å—
curl http://localhost:8100/api/v1/user_profile/test
```

### å®Œæ•´åŠŸèƒ½æµ‹è¯•æµç¨‹

```bash
# 1. ç”¨æˆ·æ³¨å†Œ
curl -X POST http://localhost:8100/api/v1/user_register/register \
  -H "Content-Type: application/json" \
  -d '{"username":"newuser","email":"new@example.com","password":"password123"}'

# 2. ç”¨æˆ·ç™»å½•
curl -X POST http://localhost:8100/api/v1/user_auth/login \
  -H "Content-Type: application/json" \
  -d '{"username_or_email":"testuser","password":"password123","remember_me":false}'

# 3. è·å–ç”¨æˆ·èµ„æ–™ï¼ˆéœ€è¦æ›¿æ¢tokenï¼‰
curl -X GET http://localhost:8100/api/v1/user_profile/me \
  -H "Authorization: Bearer <your_access_token>"

# 4. æ›´æ–°æ˜µç§°ï¼ˆéœ€è¦æ›¿æ¢tokenï¼‰
curl -X PUT http://localhost:8100/api/v1/user_profile/nickname \
  -H "Authorization: Bearer <your_access_token>" \
  -H "Content-Type: application/json" \
  -d '{"nickname":"æˆ‘çš„æ–°æ˜µç§°"}'
```

### æ•°æ®åº“æ“ä½œå‘½ä»¤

```sql
-- æŸ¥çœ‹ç”¨æˆ·è¡¨ç»“æ„
USE user_system;
DESCRIBE us_users;

-- æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·
SELECT id, username, email, nickname, is_active, created_at FROM us_users;

-- æŸ¥çœ‹ç”¨æˆ·æ˜¾ç¤ºåç§°é€»è¾‘
SELECT 
    id, 
    username, 
    nickname,
    CASE 
        WHEN nickname IS NOT NULL THEN nickname 
        ELSE username 
    END AS display_name
FROM us_users;
```

### å¼€å‘ç¯å¢ƒæ£€æŸ¥

```bash
# æ£€æŸ¥Pythonç¯å¢ƒ
python --version

# æ£€æŸ¥ä¾èµ–åŒ…
pip list | grep fastapi
pip list | grep sqlalchemy
pip list | grep pymysql

# æ£€æŸ¥MySQLè¿æ¥
mysql -u root -p -e "SHOW DATABASES;"
```

---

## âœ… é¡¹ç›®çŠ¶æ€æ£€æŸ¥æ¸…å•

### ç¯å¢ƒæ£€æŸ¥
- [ ] Python 3.8+ å·²å®‰è£…
- [ ] MySQL æœåŠ¡æ­£åœ¨è¿è¡Œ
- [ ] é¡¹ç›®ä¾èµ–å·²å®‰è£…ï¼ˆrequirements.txtï¼‰
- [ ] .env é…ç½®æ–‡ä»¶æ­£ç¡®è®¾ç½®

### æ•°æ®åº“æ£€æŸ¥
- [ ] æ•°æ®åº“ `user_system` å­˜åœ¨
- [ ] è¡¨ `us_users` å­˜åœ¨ä¸”åŒ…å« `nickname` å­—æ®µ
- [ ] æµ‹è¯•ç”¨æˆ·æ•°æ®å­˜åœ¨

### æ¨¡å—åŠŸèƒ½æ£€æŸ¥
- [ ] ç”¨æˆ·æ³¨å†Œæ¨¡å—æ­£å¸¸è¿è¡Œ
- [ ] ç”¨æˆ·è®¤è¯æ¨¡å—æ­£å¸¸è¿è¡Œ
- [ ] ç”¨æˆ·ä¸­å¿ƒæ¨¡å—æ­£å¸¸è¿è¡Œ
- [ ] æ‰€æœ‰æµ‹è¯•æ¥å£è¿”å›æ­£å¸¸

### APIåŠŸèƒ½æ£€æŸ¥
- [ ] ç”¨æˆ·å¯ä»¥æˆåŠŸæ³¨å†Œ
- [ ] ç”¨æˆ·å¯ä»¥æˆåŠŸç™»å½•
- [ ] å¯ä»¥è·å–ç”¨æˆ·èµ„æ–™
- [ ] å¯ä»¥æ›´æ–°ç”¨æˆ·æ˜µç§°
- [ ] é€€å‡ºç™»å½•åŠŸèƒ½æ­£å¸¸

---

**ğŸ‰ æ­å–œï¼ä½ å·²ç»æ‹¥æœ‰äº†ä¸€ä¸ªå®Œæ•´çš„æ¨¡å—åŒ–FastAPIç”¨æˆ·ç³»ç»Ÿï¼**

**ä¸‹ä¸€æ­¥ï¼šå¼€å‘å¯†ç ç®¡ç†æ¨¡å—ï¼Œå®Œå–„ç”¨æˆ·ç³»ç»Ÿçš„æœ€åä¸€å—æ‹¼å›¾ï¼** ğŸš€